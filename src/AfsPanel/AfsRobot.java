package AfsPanel;import PsoPanel.PsoSimulation;import SuperPack.Panel.Intelligence;import SuperPack.Panel.Point2;import SuperPack.Panel.Robot;import SuperPack.Panel.SimulationPanel;import java.awt.*;/** * Created by Ishiwatari on 2016/11/24. */public class AfsRobot extends Robot {    Intelligence oldIntelligence;    final static double ramdaA=0.1;    final static double A = 0.1;    final static double B = 0.1;    final static double C = 0.1;    protected AfsRobot(SimulationPanel s) {        super(s);        oldIntelligence = new Intelligence(p.x, p.y, s.targetList);    }    protected AfsRobot(Point2 point, SimulationPanel s) {        super(point, s);        //TODO oldInteligenceの初期化    }    protected AfsRobot(SimulationPanel s, String robotString) {        super(s, robotString);        //TODO oldInteligenceの初期化    }    @Override    public void copy(Robot robot) {        super.copy(robot);        //TODO oldInteligenceの初期化    }    @Override    public void reset() {        super.reset();    }    @Override    public void move() {        //gの合計値の計算        Point2 sigma=new Point2(0,0);        for (Robot r : field.robot) {            if (r != this) {                field.communication_num++;                sigma.add(AttractionRepulsionFunc(r.p));            }        }        //TODO ベクトルの微分        double fitness=fitnessFunction(field.targetList);        double deltaX=(ramdaA/2)*(Math.pow(fitness,2)-Math.pow(oldIntelligence.getFitnessValue(),2))/(p.x-oldIntelligence.x);        double deltaY=(ramdaA/2)*(Math.pow(fitness,2)-Math.pow(oldIntelligence.getFitnessValue(),2))/(p.y-oldIntelligence.y);        //速度決定        Point2 v= new Point2(-1*deltaX+sigma.x,-1*deltaY+sigma.y);        if (v.x > maxv) v.x = maxv;        if (v.x < -1 * maxv) v.x = -1 * maxv;        if (v.y > maxv) v.y = maxv;        if (v.y < -1 * maxv) v.y = -1 * maxv;        //位置調整        p.x+=v.x;        p.y+=v.y;        if (p.x < 0) p.x = 0;        if (p.x > SimulationPanel.size) p.x = SimulationPanel.size;        if (p.y < 0) p.y = 0;        if (p.y > SimulationPanel.size) p.y = SimulationPanel.size;        angle = Math.atan2(v.y, v.x);    }    private Point2 AttractionRepulsionFunc(Point2 pj) {        double g = A - B * Math.exp(-1 * -1 * p.distance(pj) / C);        double x = -1 * (p.x - pj.x) * g;        double y = -1 * (p.y - pj.y) * g;        return new Point2(x, y);    }    @Override    protected Point getSwingPoint() {        return (new Point((int) (p.x * PsoSimulation.length / PsoSimulation.size + PsoSimulation.startX),                (int) ((PsoSimulation.size - p.y) * PsoSimulation.length / PsoSimulation.size + PsoSimulation.startY)));    }    /**     * CIの設定     */    @Override    public void setCI() {        //今回は使わない    }}